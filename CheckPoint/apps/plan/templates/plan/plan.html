{% extends 'base.html' %}
{% load staticfiles%}
{% block title %}Plan{% endblock %}
{% block content %}
        <!--Checks if there is a userobject in user -->
        {% if user %}
            <h2>Plan for {{subject.name}}({{subject.code}})</h2>
            {% if weeks %}
                {% for week in weeks %}
                    <button class="accordion"> Uke {{ week.week_number }} </button>
                    <div class="panel">
                        <form action="{% url 'deleteWeek' %}" method="post">
                            {% csrf_token %}
                             {{ delete_week_form }}
                            <input type="hidden" name="week_id" value="{{ week.id }}"/>
                            <input type="submit" value="delete"
                            onclick="return confirm('Delete this week and all lectures in it?')"/>
                        </form>
                        {% if week.lectures.all %}
                            {% for lecture in week.lectures.all %}
                                <div class="lecture">
                                    <h3>{{ lecture.title }}</h3>
                                    <p> {{ lecture.comment }} </p>
                                    {% if objectives %}
                                        <h4>Læringsmål: </h4>
                                        <ul>
                                            {% for objective in lecture.objectives.all %}
                                                <li> {{ objective.learning_objective }} </li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}
                                    <a href="{% url 'edit' lecture.id %}"><button id="myEditBtn">Edit lecture</button></a>
                                </div>
                            {% endfor %}
                        {% else %}
                        <div class="panel">No lectures this week</div>
                    {% endif %}
                    <button id="myCreateBtn" onclick="openModal({{ forloop.counter }})"> Legg til forelesnin g</button>
                    <!-- The Modal -->
                    <div id="myCreateModal-{{ forloop.counter }}" class="modal">
                      <!-- Modal content -->
                        <div class="modal-content">
                            <form class="form-inline" action="{% url 'createLecture' plan.id week.id %}" method="post">
                            {% csrf_token %}
                                <div class="form-group">
                                    {{ create_lecture_form.as_p }}
                                </div>
                                <input class="acceptButton" type="submit" value="Lagre forelesning" />
                            </form>
                            <span class="close" onclick="closeModal({{ forloop.counter }})">&times;</span>
                        </div>
                    </div>
                    </div>
                {% endfor %}
                <form class="form-inline" action="{% url 'createWeek' plan.id %}" method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        {{ create_week_form }}
                    </div>
                    <input class="acceptButton" type="submit" value="Legg til uke" />
                </form>
            {% else %}Digdat
                 <strong>No weeks in plan</strong>
            {% endif %}
        {% else %}
            <strong>You are not logged in</strong>
        {% endif %}
        {% load static %}
        <script type="text/javascript"  src="{% static 'js/plan.js' %}"></script>
{% endblock %}
